# Local Development Profile
# Run with: ./gradlew bootRun --args='--spring.profiles.active=local'

spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5434}/${DB_NAME:docst}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: true
    clean-disabled: false  # Allow flyway clean in local

docst:
  git:
    root-path: ./data/git

  # Admin Auto-initialization (enabled in local)
  admin:
    enabled: true
    email: dev@localhost
    password: DevPassword123!
    display-name: Local Admin

  # CORS Configuration (permissive for local development)
  cors:
    enabled: true
    allowed-origins:
      - http://localhost:3000
      - http://localhost:3001
      - http://localhost:3002
      - http://localhost:3003
      - http://localhost:5173  # Vite dev server
      - http://localhost:5174
    allowed-methods:
      - GET
      - POST
      - PUT
      - PATCH
      - DELETE
      - OPTIONS
    allowed-headers:
      - "*"
    allow-credentials: true
    max-age: 3600

logging:
  level:
    com.docst: DEBUG
    org.springframework.security: DEBUG
    # MCP Server auto-configuration debug
    org.springframework.ai.mcp: DEBUG
    org.springaicommunity.mcp: DEBUG
    io.modelcontextprotocol: DEBUG

# Actuator - expose conditions for debugging auto-configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,conditions,beans,mappings

# P6Spy - SQL logging with actual values
decorator:
  datasource:
    p6spy:
      enable-logging: true
      multiline: false
      logging: slf4j
